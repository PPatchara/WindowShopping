<!DOCTYPE html>
<html>
<head>
	<title>Client | Socket TCP</title>
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black">

	<script type="text/javascript" src="js/jquery.min.js"></script>
	<script type="text/javascript" src="js/bootstrap.min.js"></script>
	<script type="text/javascript" src="js/jquery.imagemapster.min.js"></script>
	<script type="text/javascript" src="js/handlebars-v4.0.5.js"></script>
	<script type="text/javascript" src="js/lodash.min.js"></script>
	<script type="text/javascript" src="js/jquery.touchSwipe.min.js"></script>
	
	<link rel="stylesheet" href="css/bootstrap.min.css">
	<link rel="stylesheet" href="css/style3.css">
</head>
<body>

<!-- 		<img src="images/dress_cream.jpg" width="100%" height="100%" border="0" alt="" usemap="#shapes_Map">
		<map name="shapes_Map">
    		<area shape="poly" coords="506,155,532,156,545,147,561,161,600,179,607,189,610,209,608,272,606,308,615,351,619,416,617,467,598,463,596,482,590,499,589,558,597,556,600,556,604,666,600,665,589,675,575,676,566,674,551,677,539,673,523,677,511,672,488,678,473,672,461,677,444,673,429,678,418,673,395,671,388,667,403,534,431,547,435,543,434,539,425,526,430,524,431,499,427,481,419,465,415,450,395,451,388,453,385,451,387,420,385,367,389,289,391,281,392,221,391,212,395,194,398,172,401,164,403,161,417,151,429,147,446,145,456,142,506,155,504,169,499,195,502,250,509,216,513,192,507,156" 
    		href="#">

    		<area shape="poly" coords="493,867,506,890,505,898,497,908,492,919,492,953,487,952,488,938,486,954,478,968,449,973,437,971,435,969,439,957,443,947,461,948,476,947,484,943,487,920,491,906,493,868" 
    		href="#">

    		<area shape="poly" coords="516,891,508,930,504,939,499,948,503,966,514,971,529,970,546,964,549,954,549,939,550,927,545,944,541,949,518,950,507,944,509,927" 
    		href="#">
		</map> -->
<!-- 	</div> -->

	<div class="container">
		<div class="row">
			<div class="col-xs-12 col-md-12 margin-t-20">
				<img src="images/model-3/dress_snow_shoe_taupe.jpg" width="100%" height="100%" align="middle" border="0" alt="" usemap="#product_map" id="model">
				<map name="product_map">
		    		<area shape="poly" group="dress" data-current="snow" data-id="CD001" coords="506,155,532,156,545,147,561,161,600,179,607,189,610,209,608,272,606,308,615,351,619,416,617,467,598,463,596,482,590,499,589,558,597,556,600,556,604,666,600,665,589,675,575,676,566,674,551,677,539,673,523,677,511,672,488,678,473,672,461,677,444,673,429,678,418,673,395,671,388,667,403,534,431,547,435,543,434,539,425,526,430,524,431,499,427,481,419,465,415,450,395,451,388,453,385,451,387,420,385,367,389,289,391,281,392,221,391,212,395,194,398,172,401,164,403,161,417,151,429,147,446,145,456,142,506,155,504,169,499,195,502,250,509,216,513,192,507,156" 
		    		href="#">

		    		<area shape="poly" group="heels" data-current="taupe" data-id="SH001" coords="493,867,506,890,505,898,497,908,492,919,492,953,487,952,488,938,486,954,478,968,449,973,437,971,435,969,439,957,443,947,461,948,476,947,484,943,487,920,491,906,493,868" 
		    		href="#">

		    		<area shape="poly" group="heels" data-current="taupe" data-id="SH001" coords="516,891,508,930,504,939,499,948,503,966,514,971,529,970,546,964,549,954,549,939,550,927,545,944,541,949,518,950,507,944,509,927" 
		    		href="#">
				</map>
			</div>
		</div>
	</div>
	
	<script type="text/html" id="tooltips-dress">
		<div data-group="dress" data-id="CD001">
			<h4>Lace Shift Dress</h4>
			<h5 class="margin-b-10">1,229 THB</h5>
			<button type="button" class="btn btn-translucent btn-circle snow-color" data-color="snow" onclick="changeImage('dress_snow_shoe_taupe.jpg', this);"></button>
		  	<button type="button" class="btn btn-translucent btn-circle ivory-color" data-color="ivory" onclick="changeImage('dress_ivory_shoe_taupe.jpg', this);"></button>
		  	<button type="button" class="btn btn-translucent btn-circle pink-color" data-color="pink" onclick="changeImage('dress_pink_shoe_taupe.jpg', this);"></button>
		  	<button type="button" class="btn btn-primary margin-t-10">ADD TO CART</button>
		</div>
	</script>

	<script type="text/html" id="tooltips-shoe">
		<div data-group="heels" data-id="SH001">
			<h4>Handjive High Heels</h4>
			<h5 class="margin-b-10">2,200 THB</h5>
			<button type="button" class="btn btn-translucent btn-circle taupe-color" data-color="taupe" onclick="changeImage('dress_snow_shoe_taupe.jpg', this);"></button>
			<button type="button" class="btn btn-translucent btn-circle oldrose-color" data-color="oldrose" onclick="changeImage('dress_snow_shoe_oldrose.jpg', this);"></button>
			<button type="button" class="btn btn-primary margin-t-10">ADD TO CART</button>
		</div>	
	</script>
	
	
	<script>
		var ws = new WebSocket("ws://localhost:8887/pos");
		var currentProduct = [[],[]];
		var productJSON = 
		{
			"product_list": [
				{
					"category": "Clothing",
					"subcategory": "Dress",
					"id": "CD001",
					"name": "Lace Shift Dress",
					"price":  "39.50",
					"size": ["XS","S","M","L"],
					"colors": [
						{
							"name": "snow",
							"code": "#FFFAFA",
							"image": ["dress_snow_shoe_taupe.jpg","dress_snow_crop"]
						},
						{
							"name": "ivory",
							"code": "#FFF8DC",
							"image": ["dress_ivory_shoe_taupe.jpg","dress_ivory_crop"]
						},
						{
							"name": "pink",
							"code": "#F9DBE7",
							"image": ["dress_pink_shoe_taupe.jpg","dress_pink_crop"]
						}],
					"quantity" : 100,
					"description": "This shift dress features an all-over floral embroidery covering to display a dramatic sophistication while keeping it elegant and chic from brunch to cocktails.",
					"details": "- 65% Nylon. 35% Strands\n- Round neckline\n- Long sleeves\n- Front button closure\n- A-line silhouette\n- Regular fit\n- Inner lining"
				},
				{
					"category": "Shoes",
					"subcategory": "Heels",
					"id": "SH001",
					"name": "Handjive High Heels",
					"price": "45.00",
					"size": ["5","5.5","6","6.5","7","7.5","8","8.5","9","9.5","10"],
					"colors": [
						{
							"name": "taupe",
							"code": "#D1B296",
							"image": ["dress_snow_shoe_taupe.jpg","shoe_taupe"]
						},
						{
							"name": "oldrose",
							"code": "#E79679",
							"image": ["dress_snow_shoe_oldrose.jpg","shoe_oldrose"]
						}
					],
					"quantity" : 100,
					"description": "Adorn your style of the day with the sleek heels which are crafted from suede leather into almond toecap and complete the high end touch through the man made insole for comfortable wear.",
					"details": "- Genuine leather upper\n- Almond toecap\n- Balance man made\n- Genuine leather inner\n- Rubber outsole\n- Fit trues to size\n- Heel heights 8.5 cm / 3.5\""
				}
			]
		}

		function changeImage(image, button) {
			$(".mapster_el").attr('src', 'images/model-3/' + image);
			$(".mapster_tooltip button").removeClass('btn-clicked');
			$(button).addClass('btn-clicked');

			currentSelected(button);
		}

		function matchProduct() {}

		function send_current_product(product_id, color) {
			var data = JSON.stringify({
				"action": "current_product",
				"product_id": product_id,
				"color": color
			});
			ws.send(data);
			console.log(data);
		}

		function currentSelected(button) {
			var data = $(button).data();
			send_current_product($(button).parent().data('id'), data['color']);

			var group = $(button).parent().data('group');
			var elem = $("area[group="+ group +"]");
			elem.data('current', data['color']);
		}

		// $(function() {
		// 	$('.container').swipe({
		//         //Generic swipe handler for all directions
		//         swipe:function(event, direction, distance, duration, fingerCount, fingerData) {
		//           $(this).text("You swiped " + direction );
		//           console.log(direction);
		//         },
		//     });
		// });

		$(document).ready(function() {
		    $('img').mapster({
		    	showToolTip: true,
		        fillOpacity: 0,
		        fillColor: "FFFFFF",
		        strokeColor: "000000",
		        stroke: true,
		        mapKey: "group",
		        strokeWidth: 2,
		        isSelectable: false,
		        render_highlight: {
		            strokeWidth: 3
		        },
		        toolTipClose: ['toolTip-click'],
		        areas: [
		        	{
		        		key: 'dress',
		        		stroke: true,
		        		toolTip: $("#tooltips-dress").html()
		        	},
		        	{
		        		key: 'heels',
		        		stroke: true,
		        		toolTip: $("#tooltips-shoe").html()
		        	}
		        ]
		    });

			//Tap
			$(document).click(function(event) {
				console.log("Tapped target: " + event.target.id);
			});

			function hover_product() {  //edit this
				var color = $(this).data('current');
				var product_id = $(this).data('id');
				send_current_product(product_id, color);
			}

			//Hover
			$("area").hover(hover_product);

		});

	</script>
</body>
</html>